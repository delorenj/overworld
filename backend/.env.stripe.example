# Stripe Integration Configuration
# Copy this to your .env file and fill in with your actual Stripe credentials

# ============================================================================
# STRIPE API KEYS
# ============================================================================
# Get these from: https://dashboard.stripe.com/apikeys

# Secret Key (NEVER expose publicly or commit to Git!)
# Test mode: sk_test_...
# Live mode: sk_live_...
STRIPE_SECRET_KEY=sk_test_51234567890abcdefghijklmnopqrstuvwxyz

# Publishable Key (Safe for frontend)
# Test mode: pk_test_...
# Live mode: pk_live_...
STRIPE_PUBLISHABLE_KEY=pk_test_51234567890abcdefghijklmnopqrstuvwxyz

# ============================================================================
# STRIPE WEBHOOK SECRET
# ============================================================================
# Get this from: https://dashboard.stripe.com/webhooks
# After creating webhook endpoint, copy the "Signing secret"

# Webhook Signing Secret
# Format: whsec_...
STRIPE_WEBHOOK_SECRET=whsec_abcdefghijklmnopqrstuvwxyz1234567890

# ============================================================================
# RATE LIMITING
# ============================================================================

# Maximum free map generations per day for anonymous users
# Default: 3
ANONYMOUS_DAILY_LIMIT=3

# ============================================================================
# EXISTING CONFIGURATION (Required for Stripe integration)
# ============================================================================

# Redis (Required for rate limiting)
REDIS_URL=redis://:overworld_redis_password@redis:6379/0
REDIS_MAX_CONNECTIONS=50

# Database (Required for transaction storage)
DATABASE_URL=postgresql+asyncpg://overworld:overworld_dev_password@postgres:5432/overworld

# JWT (Required for authenticated checkout sessions)
JWT_SECRET_KEY=dev_jwt_secret_change_in_production
JWT_ALGORITHM=HS256

# ============================================================================
# STRIPE TESTING
# ============================================================================

# Test Credit Cards (Use these in test mode):
#
# Success: 4242 4242 4242 4242 (Any future date, any CVC)
# Decline: 4000 0000 0000 0002
# Insufficient funds: 4000 0000 0000 9995
# Requires authentication: 4000 0025 0000 3155

# ============================================================================
# WEBHOOK ENDPOINT CONFIGURATION
# ============================================================================

# Your webhook URL should be:
# https://your-domain.com/api/v1/stripe/webhook
#
# Events to listen for:
# - checkout.session.completed
# - payment_intent.succeeded
# - payment_intent.payment_failed
# - charge.refunded

# ============================================================================
# TESTING WITH STRIPE CLI
# ============================================================================

# Install: brew install stripe/stripe-cli/stripe
# Login: stripe login
# Forward webhooks: stripe listen --forward-to localhost:8000/api/v1/stripe/webhook
# Trigger event: stripe trigger checkout.session.completed

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================

# [ ] Replace test keys with live keys
# [ ] Update webhook URL to production domain
# [ ] Configure webhook in Stripe Dashboard
# [ ] Test webhook with Stripe CLI
# [ ] Verify HTTPS is enabled
# [ ] Set up monitoring for payment events
# [ ] Configure proper CORS for Stripe.js
# [ ] Review token package pricing
# [ ] Test rate limiting
